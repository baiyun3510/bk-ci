spring:
  main:
    allow-bean-definition-overriding: true
  application:
    name: log-local
    desc: DevOps Log Service
    version: 4.0
    packageName: com.tencent.devops.log
  profiles: dev
  datasource:
    url: jdbc:mysql://10.125.48.80:10000/devops_log?useSSL=false&autoReconnect=true&serverTimezone=GMT%2B8&useUnicode=true&characterEncoding=utf8&allowMultiQueries=true
    username: tig4php
    password: tig4php
  redis:
    database: 7
    host: redis.v3paas.blueking.db
    password: ENC(24ZS8Y4XnyMzKkKEhsl48q9EPtVVT1AbqJvO/jmDrBI=)
    port: 30003
  cloud:
    stream:
      service-binder: extend-rabbit
      # function:
      #   definition: logOriginEventIn;logOriginEventOut;logStorageEventIn;logStorageEventOut;logStatusEventIn;logStatusEventOut
      # bindings:
      #   ## 预处理队列
      #   logOriginEventIn-in-0:
      #     destination: e.build.log.origin.event
      #     group: log-serivce
      #     binder: extend-rabbit
      #     consumer:
      #       concurrency: 100
      #   logOriginEventOut:
      #     destination: e.build.log.origin.event
      #     binder: extend-rabbit
      #   ## 入库队列
      #   logStorageEventIn-in-0:
      #     destination: e.build.log.storage.event
      #     group: log-serivce
      #     binder: extend-rabbit
      #     consumer:
      #       concurrency: 100
      #   logStorageEventOut:
      #     destination: e.build.log.storage.event
      #     binder: extend-rabbit
      #   ## 状态队列
      #   logStatusEventIn-in-0:
      #     destination: e.build.log.status.event
      #     group: log-serivce
      #     binder: extend-rabbit
      #     consumer:
      #       concurrency: 10
      #   logStatusEventOut:
      #     destination: e.build.log.status.event
      #     binder: extend-rabbit
      rabbit:
        bindings:
          logOriginEventIn-in-0:
            consumer:
              prefetch: 1
              x-delayed-type: true
              max-concurrency: 100
          logStorageEventIn-in-0:
            consumer:
              prefetch: 1
              x-delayed-type: true
              max-concurrency: 100
          logStatusEventOut-in-0:
            consumer:
              prefetch: 1
              x-delayed-type: true
              max-concurrency: 100

server:
  port: 21914

log:
  rabbitmq:
    preprocess:
      concurrency: 10
      maxConcurrency: 100
    storage:
      concurrency: 10
      maxConcurrency: 100
  limit:
    lineMaxLength: 16384
    corePoolSize: 100
    maxPoolSize: 100
    taskQueueSize: 1000
  storage:
    enable: true
    type: elasticsearch
    coldInDay: 7
    deleteInDay: 14
    makeColdKey: routing.allocation.include.tag
    makeColdValue: cold
  elasticsearch:
    mainCluster: true
    writable: true
    ip: bkdevops-test.sz.es.db
    port: 32050
    cluster: bkdevops-test
    name: bkdevops-test
    username: bkdevops
    password: bkdevops
    shards: 1
    replicas: 1
    shardsPerNode: 1
    socketTimeout: 20000

  elasticsearch2:
    writable: true
    ip: bkdevops-test2.sz.es.svr.ehk.db
    port: 31158
    cluster: bkdevops-test2
    name: bkdevops-test2
    username: bkdevops
    password: bkdevops
    shards: 1
    replicas: 1
    shardsPerNode: 1
    socketTimeout: 20000

  lucene:
    dataDirectory: /data1/logs/buildLogs
    data-directory: /data1/logs/buildLogs
    indexMaxSize: 2147483647

auth:
  appCode: PIPELINE
  appSecret: I6ua62oGX8HocKNOpCtjrEiebQv5X5sF4jAYfvwMpYZsR6F4Qm
  url: http://authapi-dev.open.oa.com

swagger:
  append:
    name: true
